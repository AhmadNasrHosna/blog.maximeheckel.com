---
title: React sub-components
description: >-
  Making flexible, easily testable and reusable views in React without ending in
  “markup hell”
date: '2018-02-26T21:02:23.156Z'
categories: []
keywords: []
slug: react-sub-components-513f6679abed
cover: './img/1__whvWjXy__9DHnu5o6gWbpzQ.jpeg'
type: 'blogPost'
---

[_Click here to share this article on LinkedIn »_](https://www.linkedin.com/cws/share?url=https%3A%2F%2Fitnext.io%2Freact-sub-components-513f6679abed)

_This is the first article in a 3 part series about React Sub-components. Part 2 and Part 3 are available_ [_here_](https://medium.com/maxime-heckel/react-sub-components-part-2-using-the-new-context-api-6f1c089acfe4) _and_ [_here_](https://medium.com/maxime-heckel/react-sub-components-part-3-whitelisting-sub-components-with-flow-b04f9bcf80c2)_._

Every React project I’ve worked on, whether it was personal or work related, got big enough at some point that their codebase became hard to understand. Every little change required more thinking but lead to a lot of inconsistencies and hacks. Among the many issues I had with such codebases, the lack of reusability of some views was the main one: it lead to a lot of copying/pasting code of complex components/views to ensure they look the same, and the resulting duplicated code didn’t make it easier to maintain nor to test.  
Using a **sub-component** pattern can help to fix all these issues.

### What exactly is a sub-component?

For this article, we’ll consider the following view as our main example: a simple Article view to render a title, subtitle, content, metadata and comments of an article object. We’ve all dealt with such views, and they can be really problematic for the reasons stated in the intro.

By using sub-components we can render the same exact view, but with a much more readable code and a reusable component. This is what the result can look like:

In this context, sub-components are defined as **components which have their own definition declared within another parent component, and can only be used in the context of that parent component**. In the example above, the Title component for instance only exists within the scope of the Article component. It can’t be rendered on its own.  
I’m personally not sure about the name, but this is the best term I’ve found to refer to this pattern that I’ve learned to appreciate in my projects.  
Sub-components can be seen in multiple libraries such as [**Recharts**](https://github.com/recharts/recharts) or [**Semantic-UI**](https://react.semantic-ui.com/). The latter refers to sub-components as Modules, Collections and Views in its library, and gives you the ability to render views the same way as stated above.  
This kind of pattern is really beneficial:

\- **to keep views consistent**: you can actually show any kind of data using the Article component above. What matters here is that regardless of its purpose, it will look the same across the whole app.  
\- **to keep your code tight and clean**: Title, Comments, Subtitle, Metadata only make sense within Article and will only be able to be used within it (i.e. where they make sense, since these components are only used in the context of an “Article”).  
\- **to have easily testable views**: for testing such components, [Jest](https://facebook.github.io/jest/) and snapshot testing are our allies. It gives us the ability to quickly test any combination of sub-components when using Article. We’ll see how to use Jest to test such a pattern later.

### How to build sub-components

In this section we’re going to build the Article component step by step, first by trying to implement the `Title` sub-component.  
The first thing we need in order to build sub-components within a component is **a util to find children by “type” or “name”** so React will know how to render our Title sub-component. We’ll pass two parameters to this util:

- **children**: the list of children of `Article`
- **component**: the component we want to find within the list of children, in our example it will be `Title`.

Here’s how the util findByType looks like:

Now that we have our `findByType` util, we can start writing our `Article` component and the `Title` sub-component:

We now have the ability to use the `Article` component and its `Title` sub-component as such:

In order to extend our set of sub-components, we simply need to instantiate each one of them, write their corresponding render function, and call it in the main render function.  
Below you will find the fully implemented component with all its sub-components:

Note: the `renderMetadata` function is really interesting in this example, it shows how it is possible to use a single render function for two different sub-components.

### Using Jest and snapshot testing to test sub-components

Snapshot testing our sub-components is probably the quickest and safest way to make sure that any combination of sub-components within the Article component will render properly. To do this we’re going to use both Jest and Enzyme. Here’s how you can write tests for our example:

### One last note

While writing this article I noticed that sub-components wouldn’t render on IE 11 and Edge once bundled with Babel 6.26.0 and Webpack 3.10. Maybe it affects other versions, I haven’t checked yet, but all I know is that it only affected the bundled app, it worked fine when the project was running with Webpack Dev Server.

What happened? The culprit here was found when debugging the `findByType` util. `child.type.displayName || child.type.name` was returning `undefined` on IE and Edge for the following reason: “`_type_` _here is a reference to the component constructor. So if you do_ `_child.type.name_`_, it references the name property on the constructor -- no supported in IE._”

Reference: [https://github.com/facebook/react/issues/9803](https://github.com/facebook/react/issues/9803)

As a workaround I added a static variable called displayName for each one of my sub-components to ensure that they have a name. Here’s how it should look like on our example:

#### If you liked this article don’t forget to hit the “clap” button and if you have any other questions I’m always reachable on [Twitter](http://twitter.com/MaximeHeckel), or on my [website](https://maximeheckel.com). You can also subscribe to my [Medium publication](https://medium.com/maxime-heckel) to not miss my next post.

Have a wonderful day  
Maxime
